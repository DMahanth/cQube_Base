[
{
"tch_att_meta": "select count(distinct(district_id)) as total_districts, count(distinct(block_id))as total_blocks, count(distinct(cluster_id))as total_clusters,count(distinct(school_id))as total_schools, cast(sum(teachers_count)/count(distinct(month)) as int)as total_teachers,(select Data_from_date(Min(year),min(month)) from school_teacher_total_attendance where year = (select min(year) from school_teacher_total_attendance) group by year),(select Data_upto_date(Max(year),max(month)) from school_teacher_total_attendance where year = (select max(year) from school_teacher_total_attendance) group by year),month,TO_CHAR(TO_DATE (month::text, 'MM'), 'Month') AS month_name,year from school_teacher_total_attendance group by month,year;"
},
{
"tch_att_district": "SELECT district_id AS x_axis,INITCAP(district_name) AS district_name,round(cast(Sum(total_present)*100.0/Sum(total_working_days) as numeric),1)AS x_value,'latitude' AS y_axis,district_latitude AS y_value,'longitude' AS z_axis,district_longitude AS z_value,Sum(teachers_count) AS teachers_count,Count(DISTINCT(school_id)) AS total_schools,(select Data_from_date(year,month)),(select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'YYYY-MM-DD') else Data_upto_date(year,month) end as Data_upto_date),year,month FROM school_teacher_total_attendance WHERE district_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_working_days>0 GROUP BY district_id,district_latitude,district_longitude,district_name ,year,month"
},
{
"tch_att_block": "SELECT block_id AS x_axis,INITCAP(block_name) AS block_name,district_id,INITCAP(district_name) AS district_name,round(cast(Sum(total_present)*100.0/Sum(total_working_days) as numeric),1)AS x_value,'latitude' AS y_axis,block_latitude AS y_value,'longitude' AS z_axis,block_longitude AS z_value,Sum(teachers_count) AS teachers_count,Count(DISTINCT(school_id)) AS total_schools,(select Data_from_date(year,month)),(select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'YYYY-MM-DD') else Data_upto_date(year,month) end as Data_upto_date),year,month FROM school_teacher_total_attendance WHERE block_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_working_days>0 GROUP BY block_id,block_name,block_latitude,block_longitude,district_id,district_name,year,month"
},
{
"tch_att_cluster": "SELECT cluster_id AS x_axis,INITCAP(cluster_name) AS cluster_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name) AS block_name,round(cast(Sum(total_present)*100.0/Sum(total_working_days) as numeric),1)AS x_value,'latitude' AS y_axis,cluster_latitude AS y_value,'longitude' AS z_axis,cluster_longitude AS z_value,Sum(teachers_count) AS teachers_count,Count(DISTINCT(school_id)) AS total_schools,(select Data_from_date(year,month)), (select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'YYYY-MM-DD') else Data_upto_date(year,month) end as Data_upto_date),year,month FROM school_teacher_total_attendance WHERE cluster_latitude IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_working_days>0 GROUP BY cluster_id,cluster_name,cluster_latitude,cluster_longitude,block_id,block_name,district_id,district_name,year,month"
},
{
"tch_att_school": "SELECT school_id AS x_axis,INITCAP(school_name) AS school_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name)AS block_name,cluster_id,INITCAP(cluster_name) AS cluster_name,INITCAP(crc_name)AS crc_name,round(cast(Sum(total_present)*100.0/Sum(total_working_days) as numeric),1)AS x_value,'latitude' AS y_axis,school_latitude AS y_value,'longitude' AS z_axis,school_longitude AS z_value,Sum(teachers_count) AS teachers_count,Count(DISTINCT(school_id)) AS total_schools,(select Data_from_date(year,month)),(select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'YYYY-MM-DD') else Data_upto_date(year,month) end as Data_upto_date),year,month FROM school_teacher_total_attendance WHERE block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_working_days>0 GROUP BY school_id,school_name,crc_name,school_latitude,school_longitude,year,month,cluster_id,cluster_name,crc_name,block_id,block_name,district_id,district_name,year,month"
},
{
"tch_att_exception_meta":"select count(distinct(district_id)) as total_districts, count(distinct(block_id))as total_blocks, count(distinct(cluster_id))as total_clusters,count(distinct(school_id))as total_schools,(select Data_from_date(Min(year),min(month)) from teacher_attendance_exception_data where year = (select min(year) from teacher_attendance_exception_data) group by year),(select Data_upto_date(Max(year),max(month)) from teacher_attendance_exception_data where year = (select max(year) from teacher_attendance_exception_data) group by year),month,TO_CHAR(TO_DATE (month::text, 'MM'), 'Month') AS month_name,year from teacher_attendance_exception_data group by month,year;"
},
{
"tch_att_exception_district": "select a.district_latitude,a.district_longitude,a.district_id,a.district_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,a.month,a.year from (select district_id ,district_name,district_latitude,district_longitude,Count(DISTINCT(school_id)) AS total_schools_not_received,month,year from teacher_attendance_exception_data group by district_id,district_name,district_latitude,district_longitude,month,year)as a join (select a.district_id,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.district_id)as b on a.district_id=b.district_id"
},
{
"tch_att_exception_block": "select a.block_latitude,a.block_longitude,a.district_id,a.district_name,a.block_id,a.block_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,a.month,a.year from (select district_id ,district_name,block_id,block_name,block_latitude,block_longitude,Count(DISTINCT(school_id)) AS total_schools_not_received,month,year from teacher_attendance_exception_data group by district_id,district_name,block_id,block_name,block_latitude,block_longitude,month,year)as a join (select a.block_id,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.block_id)as b on a.block_id=b.block_id"
},
{
"tch_att_exception_cluster": "select a.cluster_latitude,a.cluster_longitude,a.district_id,a.district_name,a.block_id,a.block_name,a.cluster_id,a.cluster_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,a.month,a.year from (select district_id ,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude,month,year,Count(DISTINCT(school_id)) AS total_schools_not_received from teacher_attendance_exception_data group by district_id,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude,month,year)as a join (select a.cluster_id,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.cluster_id)as b on a.cluster_id=b.cluster_id"
},
{
"tch_att_exception_school": "select school_latitude,school_longitude,district_id,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,Count(DISTINCT(school_id)) AS Total_schools_with_missing_data,month,year from teacher_attendance_exception_data group by district_id ,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,school_latitude,school_longitude,month,year"
}
]
